<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Valostrats.gg</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="roster-styles.css">
    <link rel="stylesheet" href="roster-modal-footer.css">
    <link rel="stylesheet" href="dropdown-nav.css">
    <link rel="stylesheet" href="pro-matches.css">
    <link rel="stylesheet" href="mapban-styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Tungsten:wght@600&family=DIN+Next+W1G:wght@400;500;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Using Google Fonts similar to Valorant style (Tungsten is actual but usually paid, using Outfit/Roboto as clean sans-serif alternatives, or Tungsten if available via Google Fonts - it's not, using similar heavy condensed fonts like 'Oswald' or just sticking to Outfit for UI) -->
    <!-- Let's actually use 'Oswald' for headers as a good free alternative to Tungsten and 'Outfit' for body -->
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@500;700&family=Outfit:wght@300;400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <div id="app">
        <header class="app-header">
            <div class="logo" onclick="switchView('home')" style="cursor: pointer;">VALOSTRATS.GG</div>
            <nav>
                <div class="nav-dropdown">
                    <button class="nav-btn dropdown-toggle" id="strat-tools-btn">
                        Strat Tools ‚ñæ
                    </button>
                    <div class="dropdown-menu" id="strat-tools-menu">
                        <button class="dropdown-item" id="view-maps-btn">Comp Builder</button>
                        <button class="dropdown-item" id="view-mapban-btn">Map Bans</button>
                        <button class="dropdown-item" id="view-roster-btn">Team Roster</button>
                    </div>
                </div>
                <div class="nav-dropdown">
                    <button class="nav-btn dropdown-toggle" id="vct-btn">
                        VCT ‚ñæ
                    </button>
                    <div class="dropdown-menu" id="vct-menu">
                        <button class="dropdown-item" id="view-pro-matches-btn">Pro Matches</button>
                    </div>
                </div>
                <button id="view-saved-btn" class="nav-btn">Saved Comps</button>
                <span id="user-display" class="user-display hidden"></span>
                <button id="login-btn" class="nav-btn login-btn">Login</button>
                <button id="logout-btn" class="nav-btn hidden">Logout</button>
            </nav>
        </header>

        <main id="main-content">
            <!-- Dynamic Content Area -->
            <div id="loading" class="loading-screen">
                <div class="spinner"></div>
                <p>Loading Assets...</p>
            </div>
            
            <!-- Home Screen -->
            <section id="home-screen" class="view-section">
                <div class="hero-section">
                    <div class="hero-content">
                        <h1 class="hero-title">VALOSTRATS.GG</h1>
                        <p class="hero-subtitle">Master Your Strategy, Dominate the Game</p>
                        <p class="hero-description">
                            Your ultimate toolkit for Valorant team compositions, map strategies, and professional ban phase management.
                        </p>
                    </div>
                </div>
                
                <div class="features-grid">
                    <div class="feature-card" id="feature-maps">
                        <div class="feature-icon">üó∫Ô∏è</div>
                        <h2>Map Comps</h2>
                        <p>Create and save agent compositions for every map. Plan your utility, rotations, and site executes.</p>
                        <button class="feature-btn">Browse Maps ‚Üí</button>
                    </div>
                    
                    <div class="feature-card" id="feature-mapban">
                        <div class="feature-icon">üö´</div>
                        <h2>Map Ban System</h2>
                        <p>Professional map veto system with Best-of-1/3/5 formats, coin toss, and side selection.</p>
                        <button class="feature-btn">Start Ban Phase ‚Üí</button>
                    </div>
                    
                    <div class="feature-card" id="feature-roster">
                        <div class="feature-icon">üë•</div>
                        <h2>Team Roster</h2>
                        <p>Manage your team with player names and agent pools. Track who plays which agents.</p>
                        <button class="feature-btn">Manage Roster ‚Üí</button>
                    </div>
                </div>
            </section>
            
            <section id="maps-grid" class="view-section hidden">
                <!-- Maps will be injected here -->
            </section>

            <section id="comp-builder" class="view-section hidden">
                <div class="builder-layout">
                    <div class="map-stage-container">
                        <div class="map-header">
                            <button id="back-to-maps" class="icon-btn">‚Üê Back</button>
                            <h2 id="current-map-name">Map Name</h2>
                            <div class="comp-actions">
                                <input type="text" id="comp-name-input" placeholder="Comp Name (e.g. Aggressive Execute)" />
                                <div class="comp-stats" id="comp-stats">
                                    <div class="stat-item" title="Total Ability Credits">
                                        <span class="stat-label">Credits:</span>
                                        <span id="total-credits" class="stat-value">0</span>
                                    </div>
                                    <div class="stat-item" title="Total Ultimate Orbs">
                                        <span class="stat-label">Ult Orbs:</span>
                                        <span id="total-orbs" class="stat-value">0</span>
                                    </div>
                                </div>
                                <button id="save-comp-btn" class="primary-btn">Save Comp</button>
                            </div>
                        </div>
                        
                        <div class="map-visualizer" id="map-visualizer">
                            <!-- Map Image Background -->
                            <img id="map-image" src="" alt="Map View" />
                            
                            <!-- 5 Agent Slots Overlay -->
                            <div class="agent-slots-container">
                                <div class="agent-slot" data-slot-index="0"></div>
                                <div class="agent-slot" data-slot-index="1"></div>
                                <div class="agent-slot" data-slot-index="2"></div>
                                <div class="agent-slot" data-slot-index="3"></div>
                                <div class="agent-slot" data-slot-index="4"></div>
                            </div>
                        </div>
                        
                        <div class="strat-notes">
                            <h3>Strategy Notes</h3>
                            <textarea id="strat-notes-input" placeholder="Enter strategy details, execute plans, or key utility usage..."></textarea>
                        </div>
                    </div>

                    <div class="agent-picker-sidebar">
                        <div class="role-filters">
                            <button class="role-filter active" data-role="Duelist">Duelist</button>
                            <button class="role-filter" data-role="Initiator">Initiator</button>
                            <button class="role-filter" data-role="Controller">Controller</button>
                            <button class="role-filter" data-role="Sentinel">Sentinel</button>
                        </div>
                        <div id="agents-grid" class="agents-grid">
                            <!-- Agents injected here -->
                        </div>
                        
                        <!-- Team Attributes Summary -->
                        <div class="comp-attributes" id="comp-attributes">
                            <span class="attributes-label">Team Utility:</span>
                            <div id="attributes-list" class="attributes-list">
                                <!-- Attribute badges injected here -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- MAP BAN SECTION -->
            <section id="mapban-view" class="view-section hidden">
                <!-- Setup Phase -->
                <div id="mapban-setup" class="mapban-setup">
                    <h2>Map Ban Setup</h2>
                    
                    <div class="setup-card">
                        <h3>Select Ban Type</h3>
                        <div class="ban-type-options">
                            <button class="ban-type-btn active" data-type="all">All Maps</button>
                            <button class="ban-type-btn" data-type="competitive">Competitive Pool</button>
                            <button class="ban-type-btn" data-type="custom">Custom Pool</button>
                        </div>
                    </div>

                    <div class="setup-card">
                        <h3>Select Best Of</h3>
                        <div class="bestof-options">
                            <button class="bestof-btn" data-bestof="1">
                                <span class="bestof-label">Bo1</span>
                                <span class="bestof-desc">Single map</span>
                            </button>
                            <button class="bestof-btn" data-bestof="2">
                                <span class="bestof-label">Bo2</span>
                                <span class="bestof-desc">2 maps played</span>
                            </button>
                            <button class="bestof-btn active" data-bestof="3">
                                <span class="bestof-label">Bo3</span>
                                <span class="bestof-desc">First to 2 wins</span>
                            </button>
                            <button class="bestof-btn" data-bestof="5">
                                <span class="bestof-label">Bo5</span>
                                <span class="bestof-desc">First to 3 wins</span>
                            </button>
                        </div>
                    </div>

                    <div id="custom-map-selector" class="setup-card hidden">
                        <h3>Select Maps for Custom Pool</h3>
                        <div id="custom-maps-grid" class="custom-maps-grid">
                            <!-- Custom map checkboxes -->
                        </div>
                    </div>

                    <div class="setup-card">
                        <h3>Team Names</h3>
                        <div class="team-inputs">
                            <input type="text" id="team-a-name" placeholder="Team A" value="Team A" />
                            <span class="vs-text">VS</span>
                            <input type="text" id="team-b-name" placeholder="Team B" value="Team B" />
                        </div>
                    </div>

                    <button id="start-ban-btn" class="primary-btn large-btn">Start Map Ban</button>
                </div>

                <!-- Coin Toss Phase -->
                <div id="mapban-cointoss" class="mapban-cointoss hidden">
                    <h2>Coin Toss</h2>
                    <div class="cointoss-container">
                        <div class="coin" id="coin-flip">
                            <div class="coin-side heads">HEADS</div>
                            <div class="coin-side tails">TAILS</div>
                        </div>
                        <div class="cointoss-choice">
                            <p>Which team calls it?</p>
                            <button class="team-btn" id="call-team-a">Team A</button>
                            <button class="team-btn" id="call-team-b">Team B</button>
                        </div>
                        <div class="cointoss-heads-tails hidden" id="heads-tails-choice">
                            <p id="calling-team-text">Team A calls:</p>
                            <button class="choice-btn" data-choice="heads">Heads</button>
                            <button class="choice-btn" data-choice="tails">Tails</button>
                        </div>
                        <div class="cointoss-result hidden" id="cointoss-result">
                            <p id="result-text"></p>
                            <div class="turn-choice">
                                <p id="winner-text">Winner chooses:</p>
                                <button class="choice-btn" id="go-first">Go First</button>
                                <button class="choice-btn" id="go-second">Go Second</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ban/Pick Phase -->
                <div id="mapban-phase" class="mapban-phase hidden">
                    <div class="mapban-header">
                        <h2>Map Ban Phase</h2>
                        <div class="turn-indicator" id="turn-indicator">
                            <span id="current-turn-team">Team A</span>'s Turn: <span id="current-action">Ban</span>
                        </div>
                        <button id="reset-ban-btn" class="icon-btn">Reset</button>
                    </div>

                    <div id="mapban-maps-grid" class="mapban-maps-grid">
                        <!-- Map ban cards injected here -->
                    </div>

                    <div class="ban-summary">
                        <div class="team-summary">
                            <h4 id="summary-team-a">Team A</h4>
                            <div id="team-a-bans" class="bans-list"></div>
                            <div id="team-a-picks" class="picks-list"></div>
                        </div>
                        <div class="team-summary">
                            <h4 id="summary-team-b">Team B</h4>
                            <div id="team-b-bans" class="bans-list"></div>
                            <div id="team-b-picks" class="picks-list"></div>
                        </div>
                    </div>
                </div>

                <!-- Side Selection Modal -->
                <div id="side-selection-modal" class="modal hidden">
                    <div class="modal-content">
                        <h3 id="side-select-title">Team B chooses side for <span id="picked-map-name"></span></h3>
                        <div class="side-buttons">
                            <button class="side-btn attack-btn" data-side="attack">‚öîÔ∏è Attack</button>
                            <button class="side-btn defense-btn" data-side="defense">üõ°Ô∏è Defense</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Team Roster View -->
            <section id="roster-view" class="view-section hidden">
                <div class="roster-container">
                    <div class="roster-header">
                        <input type="text" id="team-name-input" class="team-name-input" placeholder="Enter Team Name" />
                    </div>
                    
                    <div class="players-grid" id="players-grid">
                        <!-- Player cards will be generated dynamically -->
                    </div>
                    
                    <div class="roster-actions">
                        <button id="save-roster-btn" class="primary-btn">Save Roster</button>
                    </div>
                </div>
            </section>

            <section id="pro-matches-view" class="view-section hidden">
                <div class="pro-matches-container">
                    <h2 class="pro-matches-title">PRO MATCH TRACKER</h2>
                    <p class="pro-matches-subtitle">Study professional team compositions from VCT tournaments</p>
                    
                    <div class="pro-matches-filters">
                        <select id="filter-map" class="filter-select">
                            <option value="all">All Maps</option>
                            <option value="Ascent">Ascent</option>
                            <option value="Bind">Bind</option>
                            <option value="Breeze">Breeze</option>
                            <option value="Haven">Haven</option>
                            <option value="Icebox">Icebox</option>
                            <option value="Lotus">Lotus</option>
                            <option value="Split">Split</option>
                            <option value="Sunset">Sunset</option>
                        </select>
                        
                        <select id="filter-tournament" class="filter-select">
                            <option value="all">VCT Champions 2024</option>
                        </select>
                        
                        <select id="filter-region" class="filter-select">
                            <option value="all">All Regions</option>
                            <option value="NA">North America</option>
                            <option value="EMEA">EMEA</option>
                            <option value="APAC">APAC</option>
                            <option value="BR">Brazil</option>
                            <option value="LATAM">LATAM</option>
                            <option value="CN">China</option>
                        </select>
                    </div>
                    
                    <div id="pro-matches-grid" class="pro-matches-grid">
                        <!-- Match cards will be populated here -->
                    </div>
                </div>
            </section>

            <section id="saved-comps-view" class="view-section hidden">
                <h2>Your Saved Comps</h2>
                <div id="saved-comps-list" class="comps-list">
                    <!-- Saved comps list -->
                </div>
            </section>
        </main>
        
        <!-- Agent Selector Modal -->
        <div id="agent-selector-modal" class="modal hidden">
            <div class="modal-content agent-selector-content">
                <div class="modal-header">
                    <h2>Select Agent</h2>
                    <button class="modal-close" onclick="closeAgentSelector()">√ó</button>
                </div>
                <div class="agent-selector-grid" id="agent-selector-grid">
                    <!-- Agent cards populated dynamically -->
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="closeAgentSelector()">Cancel</button>
                    <button class="btn-ok" onclick="confirmAgentSelection()">Add Selected</button>
                </div>
            </div>
        </div>
        
        <!-- Toast Notification -->
        <div id="toast-container" class="toast-container"></div>
    </div>
    
    <!-- Drag and Drop Polyfill if needed for mobile, but mostly sticking to Click implementation for simpler cross-platform logic first, maybe add DnD later if requested -->
    <!-- Actually, user requested DnD. I'll implement standard HTML5 DnD logic in app.js -->
    
    <!-- Firebase SDKs (using compact CDN for v9) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, doc, deleteDoc, query, orderBy, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js";
        
        // Expose to window for app.js to use (simple global approach for vanilla JS)
        window.firebaseModules = {
            initializeApp,
            getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged,
            getFirestore, collection, addDoc, getDocs, doc, deleteDoc, query, orderBy, setDoc, getDoc
        };
    </script>
    <script src="mapban.js"></script>
    <script src="roster.js"></script>
    <script src="pro-matches.js"></script>
    <script src="app.js" type="module"></script>
</body>
</html>
